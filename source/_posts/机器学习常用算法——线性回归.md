---
title: 机器学习常用算法——线性回归
date: 2017-01-05 21:27:24
categories: Algorithm
tags:
- Python
- Algorithm
- Machine Learning
- 机器学习
---

# 背景

上次的 ITA 项目开始接触机器学习相关的知识，从本文开始，我将学习并介绍机器学习最常用的几种算法，并使用 (scikit-learn)[http://scikit-learn.org/] 相关模型完成相关算法的 demo。
<!-- more -->
# 线性回归
<img src="线性回归.jpg" alt="线性回归">
线性回归，是利用数理统计中回归分析，来确定两种或两种以上变量间相互依赖的定量关系的一种统计分析方法。我们通过拟合最佳直线来建立自变量和因变量的关系，这条最佳直线叫做回归线，并且用 Y= a*X + b 这条线性等式来表示。

理解线性回归可以想象一下一般人身高与体重之间的关系，在不能准确测试体重的情况下，按照身高进行排序，也能大体得出体重的大小。这是现实生活中使用线性回归的例子。
在这个例子中，Y 是体重（因变量），X 是身高（自变量），a 和 b 分别为斜率和截距，可以通过最小二乘法获得。

## 身高体重

### 准备数据

自己伪造了一些数据

```python
import matplotlib.pyplot as plt
def runplt():
    plt.figure()
    plt.title(u'Height-Weight')
    plt.xlabel(u'Height')
    plt.ylabel(u'Weight')
    plt.axis([150, 190, 40, 120])
    plt.grid(True)
    return plt

plt = runplt()
X = [[155], [157], [166], [177], [187]]
y = [[55], [60], [63], [70], [79]]
plt.plot(X, y, 'k.')
plt.show()
```
<img src="/assets/img/线性回归_1.png" alt="线性回归">

### 创建并拟合模型

```python
from sklearn.linear_model import LinearRegression
import numpy as np
# 创建并拟合模型
model = LinearRegression()
model.fit(X, y)
print('预测身高180同学的体重：$%.2f' % model.predict(np.array([180]).reshape(-1, 1))[0])
```

上述代码中sklearn.linear_model.LinearRegression类是一个估计器（estimator）。估计器依据观测值来预测结果。在scikit-learn里面，所有的估计器都带有: 
- fit() 
- predict()

fit() 用来分析模型参数，predict() 是通过 fit()算出的模型参数构成的模型，对解释变量进行预测获得的值。 
因为所有的估计器都有这两种方法，所有 scikit-learn 很容易实验不同的模型。


## 线性回归分类

线性回归的两种主要类型是一元线性回归和多元线性回归。一元线性回归的特点是只有一个自变量。多元线性回归则存在多个自变量。找最佳拟合直线的时候，你可以拟合到多项或者曲线回归。这些就被叫做多项或曲线回归。



